# 메모리 영역(Code, Data, Stack, Heap)

프로그램을 실행하면 운영체제는 메모리(RAM) 공간을 확보하여 프로그램에 할당해준다. 이때 할당되는 메모리 공간은 크게 코드(code), 데이터(data), 스택(stack), 힙(heap) 영역으로 나뉜다. 아래는 C언어의 메모리 구조이다.  

![C언어의 메모리의 구조](https://perfectacle.github.io/2017/02/09/C-ref-004/memory.png)  

<br>

### **1) Code**

작성된 소스 코드가 들어간다. 상수 또한 여기에 들어간다. 프로그램이 끝날 때까지 메모리에 적재된다.

### **2) Data**

전역 변수, static 변수 등등이 저장된다. 프로그램이 끝날 때까지 메모리에 계속 적재된다.

### **3) Stack**

지역 변수, 매개 변수, 리턴 값 등등이 저장된다. 함수 호출시 생성되고, 함수가 종료되면 시스템에 반환된다. 프로그램이 자동으로 사용하는 임시 메모리 영역이다. 컴파일 시에 크기가 결정된다.

### **4) Heap**
C에서는 프로그래머가 할당, 해제하는 메모리 공간이다. malloc() 또는 new 연산자를 통해 할당하고, free() 또는 delete 연산자를 통해서만 해제 가능하다. Java와 Javascript에서는 가비지 컬렉터가 자동 해제한다. 이 공간에 메모리를 할당하는 것을 **동적 할당(Dynamic Memory Allocation)**이라고 부른다. 데이터 영역과 스택 영역은 컴파일러가 미리 공간을 예측하고 할당하는데 사용하는 영역인데 반해, 힙 영역은 런타임 중에 크기가 결정될 수 있는 요소들이 올라갈 수 있는 공간이다. (즉 미리 할당할 공간을 정해놓는 것이 아니라, 데이터의 길이만큼 늘였다 줄였다 할 수 있다.)

Stack 영역이 클수록 Heap 영역이 작아지고, Heap 영역이 커지면 Stack 영역이 작아진다.


## 자바스크립트는?

자바스크립트는 인터프리터 언어이다. 컴파일과 런타임이 분리되어 있지 않고 동시에 이루어진다.
자바스크립트는 동적 타이핑을 채택한 언어이다. var로 모든 타입의 변수를 선언하므로 들어오는 데이터에 의해 메모리가 할당된다.
자바나 C, 파이썬과 같은 대부분의 언어는 정적 타이핑을 채택한다. 정적 타이핑은 변수를 선언할 당시에 데이터의 타입을 정해주는 방식이다.

```javascript
//자바스크립트의 변수 선언 방식: 동적 타이핑
var str = 'hello world';
var word = 'world';
var num = 11;
```

```java
//자바의 변수 선언 방식: 정적 타이핑
String str = "hello world";
char word = 'world';
int num = 11;
```

자바스크립트의 객체(Object)와 String의 메모리 할당은 힙 영역에서 이루어진다.
기본자료형, 원시자료형이라 불리는 프리미티브의 경우 stack 영역의 메모리 할당이 이루어진다.
stack영역은 정적 할당 영역으로, 일단 할당된 메모리는 어떠한 변경도 불가하다. 프리미티브 객체는 각 타입별로 4~8byte의 메모리 공간을 차지한다.

정리하면,

var 키워드로 변수 선언 -> 자바스크립트 엔진의 동적 타이핑(데이터 타입(type) 판별)  
IF: 프리미티브 타입(기본자료형)이다 -> 메모리의 스택 영역을 고정 크기로 할당 (정적 할당)  
IF: 오브젝트 타입(Obejct)이거나 String이다 -> 메모리의 힙 영역을 가변 크기로 할당 (동적 할당)

---

**Reference**

[blog](https://perfectacle.github.io/2017/02/09/C-ref-004/)

